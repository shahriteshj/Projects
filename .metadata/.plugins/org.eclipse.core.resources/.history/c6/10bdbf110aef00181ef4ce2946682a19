/**
 * 
 */
package com.jp.db;

import java.sql.*;

import javax.sql.RowSet;

/**
 * @author Administrator
 *
 */
public class ConnectionUtil {
    public static Connection getConnection()throws ClassNotFoundException, SQLException{

        Class.forName("oracle.jdbc.OracleDriver");
            System.out.println("JDBC Driver found and Loaded!");

        //Step 2: Create a connection
        Connection    con = DriverManager.getConnection(
                    "jdbc:oracle:thin:@localhost:1521/orcl","hr","hr");
            System.out.println("Connected to DB");
    return con;
    }

    
    public boolean UserExists(String userName, String password){
    	PreparedStatement ps;
    	ResultSet rs;
    	final String strQuery = "SELECT * FROM EMPLOYEES WHERE Upper(FIRST_NAME) = ? and LAST_NAME = ?";
    	
    	try{
    	Connection conn = ConnectionUtil.getConnection();
    	
    	
    	ps = conn.prepareStatement(strQuery);
    	ps.setString(1, userName.toUpperCase());
    	ps.setString(2, password);
    	rs = ps.executeQuery();
    	if(rs.next()){
    		return true;
    	}
    	
    		return false;
    	
    	}catch(SQLException SQLex){
    		
    	}catch(ClassNotFoundException cnfException){
    		
    	}
		
    	
    	
    }
    
}
